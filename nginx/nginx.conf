# run nginx as the nginx user for safety
user nginx;

# use as many worker processes as available CPU cores
worker_processes auto;

# send nginx errors to docker logs (stderr)
error_log /dev/stderr info;

# pid file for process control
pid /var/run/nginx.pid;

events
{
	# allow up to 1024 connections at the same time
	worker_connections 1024;
}

http
{
	# include MIME types for proper file serving
	include /etc/nginx/mime.types;
	default_type application/octet-stream;

	# use efficient file sending
	sendfile on;
	keepalive_timeout 65;

	# define a single server block (our static page)
	server
	{
		# listen on port 80 (inside the container only)
		listen 80 default_server;

		# generic hostname, since Tor handles domain mapping
		server_name _;

		# root directory for static files
		root /usr/share/nginx/html;
		index index.html;

		# serve files directly otherwise return 404
		location /
		{
			try_files $uri $uri/ = 404;
		}

		# log access and errors to docker logs
		access_log /dev/stdout;
		error_log /dev/stderr info;
	}
}